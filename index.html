<!DOCTYPE html>
<html>
<head>
  <title>Private Radio Station</title>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.0/jquery.min.js"></script>
  <script>
  var oldcontent = "";
  function print_songs(){
    $.ajax(
      {
        url: "http://your.webpage.radio/songinfo.php",
        method: "GET",
        data: {
          oldcontent: oldcontent
        },
        cache: false,
        timeout: 70000, // Set a bit longer than max delay of songinfo.php
        success: function(result){
          if(result.length < 500){//there is file
            result = result.split("\n");
            $("#programme").html(result[0]);
            $("#currentsong").html(result[1]);
            $("#nextsong").html(result[2]);
            oldcontent = result;
          } else { //no file (large search result is returned)
            $("#programme").html("Info is missing");
            $("#currentsong").html("-");
            $("#nextsong").html("-");
          }
        },
        statusCode: {
          404: function() {
            $("#programme").html("404");
          }
        },        
        fail: function(){
          $("#programme").html("Ajax request failed");
          $("#currentsong").html("-");
          $("#nextsong").html("-");
        },
        error: function(){
          $("#programme").html("Ajax request timeout");
          $("#currentsong").html("-");
          $("#nextsong").html("-");
        },
        complete: function(){
          setTimeout(print_songs, 100);
        }
      }  
    );
  }
  $(document).ready(print_songs);
  </script>
</head>
<body>
  <h1>Private Radio Station</h1>
  <p>
    This html file is an example how to create webpage which always shows
    up to date and auto updated information about your radio station
    which programme is currently active and
    which song is currently playing and which will be the next song. 
  </p>  
  <div>
  <br><strong>Programme: <span id="programme">-</span></strong>
  <br><strong>Now playing:</strong> <span id="currentsong">-</span>
  <br><strong>Next song:</strong> <span id="nextsong">-</span>
  </div>
  <p>
    This solution has very less delay and is always in synchron.
    Furthermore uses small amout of data transfer and resource.
  </p>
  <p>
    This is ensured by a server side PHP script (songinfo.php).
    Javascript sends an AJAX request to server, and the current
    songs are in the parameter. Server side is waiting maximum
    one minute for the songs are updated by player script.
    It checks the songs (songinfo.txt) every half seconds.
    If songs read from songinfo.txt is different from the currently
    displayed songs, songinfo.php returns immediately with the
    new songs, and webpage shows the new songs also immediately.
    If there is no song update, songinfo.php waits half sec and
    read songs again and check for change.
    If there was no update through one minute, songinfo.php
    returns with the same songs, and new AJAX request is started
    again.
  </p>  
  <p>
    Just do not forget to update url of your webpage and file above in line 11.
  </p>  
</body>
</html>
